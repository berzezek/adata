# Получение данных с Adata

# Установка окружения
```bash
python -m venv venv
source venv/bin/activate # Linux
venv\Scripts\activate # Windows

pip install -r requirements.txt
```
# Создание файла .env
```bash
# Создайте файл .env в корне проекта и добавьте туда ваши переменные окружения
TOKENS=oQSG49tlkZgFpxsdJVjCPTYuq09xFuPye
URL=https://api.adata.kz/

MAX_RETRIES=1
RETRY_INTERVAL=1
CHECK_URL=api/company/info/check/
```

# Запуск
```bash
python app.py
```

```text
В случае ошибки или прекращения работы программы (например истечения действия токена), то можно возобновить с нужной строки
для этого необходимо в app.py изменить RESUME_INDEX = <номер строки с которой нужно продолжить>
```

```text
Запускается main.py. Ввоводится диапазон БИН-ов из файла
Скрипт запускает test_1_async.py и test_2_async.py.

test_1_async.py считывает БИН-ы из файла в заданном диапазоне. Делает запросы во все endpoint
и возвращает токены которые записываются в response_tokens.json (файл перезаписывается при каждом запуске).
После выполнения ожидаем некоторое время пока запросы обработуются на сервере (5 мин).

test_2_async.py считывает токены из response_tokens.json и записывает успешные ответы в файл results\responses.json (в файл добавлются новые записи).

Те запросы которые еще не успели обработать на сервере (status=wait) добавляются в results\wait.json.

Ответы 404 могут быть если БИН не находит в Адате, или если этот БИН относиться к физ. лицу (нужны другие endpoint-ы).
Такие запросы записываются в results\fl.json.

Ответы 500 записываются в results\error.json. Пока что не понятна причина.

На данные момент загружены с 0 по 1000.
Следующий должен быть с 1000 по 2000.
```

```text
В env есть прокси, на рабочих компьютерах нужна авторизация.
```